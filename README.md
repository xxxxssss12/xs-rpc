# xs-rpc

旨在从零开始撸一个rpc框架，撸完可能加上服务注册发现、spring整合等上层环节。

## 什么是rpc？

RPC是指远程过程调用，也就是说两台服务器A，B，一个应用部署在A服务器上，想要调用B服务器上应用提供的函数/方法，
由于不在一个内存空间，不能直接调用，需要通过网络来表达调用的语义和传达调用的数据。

## 怎么实现rpc

要实现一个RPC框架主要实现3点。

1. 方法映射-本地方法代理远程调用，通过此方法获取到此方法的远程信息（ip+端口等）
2. 参数序列化/反序列化
3. 网络传输协议 


Call ID映射可以直接使用函数字符串，也可以使用整数ID。
映射表一般就是一个哈希表。序列化反序列化可以自己写，也可以使用Protobuf或者FlatBuffers之类的。
网络传输库可以自己写socket，或者用asio，ZeroMQ，Netty之类。


具体一点应该这么划分

* client初始化
* client调用rpc方法
* server初始化
* server接收rpc请求并调用本地方法

接下来要做的是梳理这4个步骤，抽取公共方法

### client 初始化 + 调用rpc方法

1. 加载服务提供方信息-ip+端口、超时时间
2. 通过引用列表配置，获取如下信息
    1. 服务名
    2. 服务提供方接收协议类型
3. 对引用列表配置中的接口进行代理操作，获取其：
    1. 方法名
    2. 方法参数
    3. 方法返回类型
4. 配置通信框架
5. 通过通信框架建立长连接——至此初始化完毕。
6. 上层通过代理方法调用，触发远程rpc请求逻辑（代理消费方法程序流程）
    1. 封装通用参数数据data
    2. 转化成指定协议，encode
    3. 通过通信框架请求远端
    4. 接收到远端返回数据
    5. 按指定协议转化成通用参数数据data，decode
    6. 如果返回是exception，抛出异常
    7. 如果返回不是exception，返回。